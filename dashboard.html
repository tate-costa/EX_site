<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.3.1/firebase-firestore.js"></script>
</head>
<body>
  <h1>Welcome to the Dashboard</h1>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gymnastics Dashboard</title>
  <style>
    body { font-family: Arial; padding: 20px; background-color: #f4f4f4; }
    select, input[type="text"], input[type="number"] { padding: 6px; margin: 4px; }
    .submitBtn, #downloadBtn { margin-top: 10px; padding: 8px 16px; background-color: #0077cc; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .submitStatus { font-style: italic; color: green; margin-top: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    #eventForm, #dataBreakdown { margin-top: 20px; background: #fff; padding: 15px; border-radius: 6px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <h1>Gymnastics Dashboard</h1>

  <label for="eventSelect">Select Event:</label>
  <select id="eventSelect">
    <option value="">--Choose an event--</option>
    <option value="FX">FX</option>
    <option value="PH">PH</option>
    <option value="SR">SR</option>
    <option value="VT">VT</option>
    <option value="PB">PB</option>
    <option value="HB">HB</option>
  </select>

  <div id="eventForm"></div>

  <h2>ðŸ“Š Data Breakdown</h2>
  <div id="dataBreakdown">
    <table>
      <thead>
        <tr><th>Timestamp</th><th>Event</th><th>Skill</th><th>Value</th><th>Deduction</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="downloadBtn">Download CSV</button>
  </div>

  <script>
    const eventSelect = document.getElementById("eventSelect");
    const eventForm = document.getElementById("eventForm");
    const breakdownBody = document.querySelector("#dataBreakdown tbody");

    eventSelect.addEventListener("change", () => {
      const selectedEvent = eventSelect.value;
      eventForm.innerHTML = "";
      if (!selectedEvent) return;

      const table = document.createElement("table");
      table.innerHTML = `
        <thead>
          <tr><th>Skill</th><th>Value</th><th>Deduction</th></tr>
        </thead>
        <tbody>
          ${Array.from({ length: 8 }).map(() => `
            <tr>
              <td><input type="text" placeholder="Skill name"></td>
              <td><input type="number" placeholder="Value" step="0.1" min="0"></td>
              <td><input type="number" placeholder="Deduction" step="0.1" min="0"></td>
            </tr>
          `).join('')}
        </tbody>
      `;
      eventForm.appendChild(table);

      const submitBtn = document.createElement("button");
      submitBtn.className = "submitBtn";
      submitBtn.textContent = "Submit Scores";

      const statusMsg = document.createElement("p");
      statusMsg.className = "submitStatus";

      submitBtn.addEventListener("click", () => {
        const rows = table.querySelectorAll("tbody tr");
        const timestamp = new Date().toLocaleString();
        let valid = false;

        rows.forEach(row => {
          const name = row.querySelector("input[type='text']").value.trim();
          const value = parseFloat(row.querySelector("input[placeholder='Value']").value);
          const deduction = parseFloat(row.querySelector("input[placeholder='Deduction']").value);
          if (name && !isNaN(value) && !isNaN(deduction)) {
            valid = true;
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${timestamp}</td><td>${selectedEvent}</td><td>${name}</td><td>${value}</td><td>${deduction}</td>`;
            breakdownBody.appendChild(tr);
          }
        });

        statusMsg.textContent = valid ? `âœ… Submitted on ${timestamp}` : "Please enter at least one complete skill entry.";
      });

      eventForm.appendChild(submitBtn);
      eventForm.appendChild(statusMsg);
    });

    document.getElementById("downloadBtn").addEventListener("click", () => {
      const rows = Array.from(document.querySelectorAll("#dataBreakdown tbody tr"));
      const csv = rows.map(row =>
        Array.from(row.children).map(cell => `"${cell.textContent}"`).join(",")
      ).join("\n");

      const blob = new Blob([csv], { type: "text/csv" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "gymnastics_data.csv";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  </script>
</body>
</html>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD3cJtk0c42pNAr3tsi_gQ7_9KcQS-HvgA",
      authDomain: "extracker-d2148.firebaseapp.com",
      projectId: "extracker-d2148",
      storageBucket: "extracker-d2148.firebasestorage.app",
      messagingSenderId: "203023038950",
      appId: "1:203023038950:web:bc5cc0633c129e0cb2fe27",
      measurementId: "G-XPQ7THPEKD"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Example: Check if user is logged in
    auth.onAuthStateChanged(user => {
      if (user) {
        console.log("Logged in as:", user.email);
        // Load user-specific dashboard data here
      } else {
        window.location.href = "login.html"; // redirect if not logged in
      }
    });
  </script>
</body>
</html>
